# from kiwipiepy import Kiwi
# from sentence_transformers import SentenceTransformer, util
# import pymysql
#
# import re
#
# # 모델 로드 (Ko-sBERT: 의미 기반 한국어 문장 임베딩)
# model = SentenceTransformer("snunlp/KR-SBERT-V40K-klueNLI-augSTS")
# kiwi = Kiwi()
# # DB 연결
# conn = pymysql.connect(
#     host='10.50.131.18',
#     port = 3306,
#     user='user',
#     password='user1234',
#     database='maildb',
#     charset='utf8'
# )
# # 키워드 목록 예시 (한글)
# """
# finance_keywords = [
#     "카드", "신용카드", "체크카드", "금융", "은행", "명세서", "사용 내역", "거래 내역",
#     "대출", "대출금", "이자", "상환", "연체", "계좌", "잔액", "이체", "출금", "입금",
#     "자동이체", "청구서", "납부", "수수료", "결제", "카드 승인", "결제 알림",
#     "한도 초과", "통장", "이체 확인", "송금", "지급", "환전", "외환", "환율",
#     "적금", "예금", "펀드", "증권", "주식", "채권", "금융상품", "리볼빙", "카드대금",
#     "결제내역", "할부", "무이자할부", "모기지론", "담보대출", "신용등급", "신용조회",
#     "통장정리", "잔액조회", "인터넷뱅킹", "모바일뱅킹", "금융이체", "조회내역",
#     "계좌번호", "출금내역", "입금내역", "금융알림", "대출상환일", "분할상환",
#     "연체료", "연체이자", "부가세", "이자율", "금융상품안내", "대출안내", "카드신청",
#     "회원등급", "포인트적립", "캐시백", "수익률", "거래확인", "출금요청",
#     "입금확인", "자동이체등록", "자동이체해지", "계좌개설", "계좌해지", "금융상담",
#     "금융고지", "금융고지서", "명세서발송", "펀드수익", "예금만기", "대출만기",
#     "계좌정지", "카드정지", "카드재발급", "분실신고", "SMS알림", "입출금알림",
#     "한도설정", "해외송금", "송금수수료",
#     "투자증권", "저축은행", "신용협동조합", "캐피탈", "자산운용", "지점", "본사", "계열사",
#     "금융회사", "종합금융", "투자자문", "회계법인", "신용정보", "금융지주", "새마을금고",
#     "단위농협", "보험료", "보험금", "투자", "연금", "신탁", "퇴직연금", "주택담보",
#     "전세자금", "신용대출", "마이너스통장", "청약", "해외주식", "국내주식", "공모주",
#     "로보어드바이저", "비상장", "상장", "선물", "옵션", "부동산", "비트코인", "암호화폐",
#     "디지털자산", "포트폴리오", "운용", "분석", "원리금", "비과세", "확정금리", "변동금리",
#     "만기환급", "중도인출", "계약", "해지", "증권계좌", "종합자산관리", "재테크",
#     "은퇴설계", "상속", "증여", "파생상품", "주가지수연동", "주식형", "채권형", "혼합형",
#     "원금보장", "원금손실", "분할상환", "거치식", "적립식", "주가연계", "파생결합",
#     "대체투자", "특별계정", "일반계정", "변액", "종신", "정기", "건강", "실손", "자동차보험",
#     "화재보험", "여행자보험", "저축보험", "교육보험", "어린이보험", "치아보험", "해외여행보험",
#     "국내여행보험", "유가증권", "신탁상품", "신탁계정", "퇴직연금상품", "개인형", "확정기여형",
#     "확정급여형", "주택청약", "청약저축", "무이자", "할부금융", "리스", "렌탈", "금리우대",
#     "수수료면제", "카드발급", "카드갱신", "카드해지", "카드정지", "후불교통", "포인트",
#     "마일리지", "기프트카드", "법인카드", "개인카드", "가족카드", "하이패스카드", "현금서비스",
#     "카드론", "결제일할인", "무실적카드", "할인카드", "적립카드", "제휴카드", "프리미엄카드",
#     "자동납부", "자동송금", "예약이체", "간편결제", "간편송금", "외화예금", "외화대출",
#     "환율우대", "환리스크", "특판", "특별판매", "저금리", "고금리",
#     "거래", "내역", "사용", "승인", "취소", "환불", "정산", "잔고", "증거금", "위탁", "담보",
#     "약정", "매도", "매수", "체결", "체결내역", "미수", "반대매매", "평가", "평가손익",
#     "이익", "손실률", "수익률", "손익분기", "미수금", "미지급금", "미납금", "매매", "매매내역",
#     "입출금", "카드사용", "승인번호", "할부", "일시불", "선결제", "부분결제", "청구금액",
#     "미결제", "연체료", "연체이자", "납입", "납입액", "납입일", "보험청구", "보험금지급",
#     "보험료납입", "보험계약", "보험증권", "보험설계", "보험갱신", "보험만기", "보험료할인",
#     "보험금수령", "보험금청구", "보험료미납", "보험료환급", "보험료인상", "보험료인하",
#     "보험료조회", "보험료계산", "보험료변동", "보험료확정", "보험료납부", "보험료납부내역",
#     "보험료납부확인", "보험료납부방법", "보험료납부일", "보험료납부일정", "보험료납부기한",
#     "보험료납부독촉", "보험료납부안내", "출금정지", "지급정지", "이체한도", "결제한도",
#     "사용한도", "신용한도", "예금자보호", "압류", "압류해제", "채무", "채권", "채권추심",
#     "채무조정",
#     "안내", "변경", "확인", "통보", "알림", "유의", "정보", "소식", "동향", "전망", "분석",
#     "보고서", "상담", "문의", "약관", "동의", "설명서", "공시", "투자설명서", "유의사항",
#     "고지", "운용보고서", "재무보고서", "고객센터", "상담사", "자동응답", "시스템", "서비스",
#     "자료", "기록", "서류", "양식", "증명서", "확인서", "신청서", "신청방법", "제출서류",
#     "필요서류", "구비서류", "절차", "방법", "절차안내", "업데이트", "점검",
#     "고객", "회원", "비밀번호", "아이디", "로그인", "본인확인", "인증", "보안", "공인인증서",
#     "휴대폰인증", "바이오인증", "회원정보", "개인정보", "비대면", "계좌개설", "계좌폐쇄",
#     "계좌관리", "실명확인", "고객번호", "고객정보", "고객확인", "고객인증", "사용자",
#     "본인인증", "공동인증서", "금융인증서", "간편인증", "지문인증", "안면인증", "패스워드",
#     "시장", "경제", "금리", "환율", "지수", "주가지수", "코스피", "코스닥", "유가", "물가",
#     "성장률", "경기", "인플레이션", "디플레이션", "통화", "통화량", "중앙은행", "기준금리",
#     "시중금리", "국제", "국내", "글로벌", "위기", "리스크", "변동성", "안전자산", "위험자산",
#     "경제지표", "금융지표", "국채", "회사채", "원자재", "환율변동", "금리인상", "금리인하",
#     "경기침체", "경기회복", "통계", "전망치", "예측", "금융시장", "자본시장", "외환시장",
#     "통화시장", "채권시장", "파생상품시장", "주식시장",
#     "자산", "부채", "현금", "현금흐름", "여유자금", "가계", "기업", "개인", "법인", "소득",
#     "자본", "부채비율", "점수", "평가", "재무제표", "손익", "현황", "출자", "자금",
#     "자금조달", "자금운용", "자금관리", "자산관리", "자산증식", "부채관리", "가계부채",
#     "기업대출", "가계대출", "증권사고", "금융사고", "사고조사", "사고접수", "상담원 연결",
#     "상담예약", "상담전화", "콜센터", "서비스센터", "부가서비스", "유동성", "건전성", "투자성향"
#
# ]
#
# government_keywords = [
#     "국세청", "세금고지", "세금납부", "세금계산서", "연말정산 안내", "연말정산확인",
#     "소득증명", "소득확인서", "환급안내", "건강보험고지", "국민연금고지",
#     "건강보험료", "국민연금보험료", "고용보험고지", "고지서", "납부기한안내",
#     "정부24알림", "민원24처리", "인증서갱신", "공공기관공지", "보조금안내",
#     "보조금신청", "보조금지급", "주민센터안내", "주민등록증", "주민등록표",
#     "전입신고완료", "전입신고안내", "출입국관리", "전자세금계산서발송",
#     "전자고지서", "세무서안내", "세무서고지", "납세자안내", "소득공제안내",
#     "의료비공제", "영수증제출", "정책안내", "행정처리결과", "질병청보건",
#     "질병예방안내", "재난지원금", "긴급재난금", "지원금지급", "재난지원안내",
#     "복지서비스안내", "정부알림", "정책공고", "공공데이터", "환경부알림",
#     "교통안전공지", "보건복지부", "교육부알림", "고용노동부", "행정안전부",
#     "문화체육관광부", "산업통상자원부", "통계청", "출입통제", "주민세고지",
#     "부가가치세고지", "지방세고지", "증빙자료", "지자체안내", "공유재산안내",
#     "도로점검", "공사안내", "주민참여", "투표안내", "선거결과", "행정서비스",
#     "본인인증서", "공증서류", "법제처공지", "행정처분", "세무조사안내",
#     "방역지침", "예방접종안내", "긴급안전정보", "가스검침", "수도검침",
#     "전기검침", "생활민원처리", "금융감독원", "감독원고시", "환경검사",
#     "식품안전정보", "농림축산부", "산림청", "통계공표", "정책해설", "공청회안내","가족부","소득세","보건","복지부","지원금",
#     "병무청","자원부","법령","국토","교통부","제도","바우처","정책","통계청","복지","병역",
#     "의무","수산부","행정","안전부","환경부","관광부","장려금","기업부","주택청약","지원금",
#     "안전처","식품의약품안전처","병무청","국토교통부","보건복지부","행정안전부","여성가족부","환경부",
#     "교육부","해양수산부","정책","제도","복지","고용지원금","국세청","에너지 바우처",
#     "건강보험료","정부","고용노동부","산업통상자원부",""
# ]
#
# portal_keywords = [
#     "아이디", "비밀번호", "로그인", "로그아웃", "가입", "탈퇴", "회원", "비회원", "정보", "수정",
#     "변경", "이름", "이메일", "주소", "전화번호", "휴대폰", "본인", "인증", "확인", "재설정",
#     "설정", "환경설정", "개인", "개인정보", "보호", "보안",
#     "프로필", "사진", "사용자", "내정보", "이용", "내역", "기록", "활동", "접속", "관리",
#     "동의", "약관", "정책", "개인정보처리", "권한", "접근", "차단", "해제", "정지", "복구",
#     "계정", "연동", "등록", "삭제", "생성", "만료", "기간", "유효", "메시지",
#     "쪽지", "알림", "푸시", "수신", "발신", "보낸", "받은", "읽지않은",
#     "메인", "홈", "메뉴", "콘텐츠", "게시물", "게시판", "작성", "등록", "수정", "삭제",
#     "댓글", "답글", "공유", "저장", "다운로드", "업로드", "열람", "보기", "읽기",
#     "듣기", "재생", "목록", "분류", "카테고리", "정렬", "필터", "설정", "보기설정",
#     "파일", "첨부", "문서", "편집", "미리보기", "인쇄", "스크랩",
#     "북마크", "즐겨찾기", "관심", "모음", "갤러리", "앨범", "슬라이드", "확대", "축소", "화면",
#     "크기", "해상도", "속도", "로딩", "오류", "장애", "복구", "개선", "업데이트", "버전",
#     "새로운", "변경", "추가", "알림", "구독", "해지", "뉴스", "언론", "기사", "연예",
#     "스포츠", "웹툰", "날씨", "쇼핑", "지도", "길찾기", "교통", "버스", "지하철", "환승",
#     "주변", "장소", "상점", "식당", "카페", "병원", "약국", "주유소", "숙박", "여행",
#     "여가", "문화", "전시", "공연", "영화", "드라마", "음악", "독서", "도서", "교육",
#     "학습", "시험", "문제", "정답", "해설", "강의", "학원", "학교", "졸업", "취업",
#     "면접", "이력서", "자기소개서", "채용", "구인", "구직", "아르바이트", "직업", "경력",
#     "대화", "채팅", "메시지", "쪽지", "댓글", "답글", "작성", "보내기", "받기", "확인",
#     "읽음", "안읽음", "발신", "수신", "대화방", "그룹", "친구", "팔로우", "팔로잉", "팔로워",
#     "관계", "추가", "삭제", "차단", "해제", "신고", "차단목록", "초대", "가입", "탈퇴",
#     "운영", "관리", "스팸", "필터", "정화", "규칙", "안내", "공지", "알림", "푸시",
#     "설정", "변경", "숨김", "보관", "즐겨찾기", "관심", "이웃", "방문자", "게시물", "의견",
#     "제안", "불만", "건의", "고객센터", "도움말", "문의",
#     "전화", "이메일", "온라인", "오프라인", "게시판", "포럼", "커뮤니티", "카페", "블로그",
#     "글쓰기", "사진첩", "동영상", "업로드", "공유하기", "소셜", "네트워크", "관계망", "친구찾기", "그룹채팅",
#     "단체", "비공개", "공개", "회원정보", "선물", "이모티콘", "알람"
# ]
#
#
# advertisement_keywords = [
#     "할인", "세일", "기간한정", "특가", "최저가", "이벤트", "무료", "증정", "쿠폰", "코드",
#     "기획전", "선착순", "한정수량", "특별가", "파격할인", "반값", "보너스", "캐시백", "포인트",
#     "적립", "마일리지", "사은품", "경품", "추첨", "당첨", "응모", "혜택", "찬스", "득템",
#     "빅세일", "메가세일", "슈퍼세일", "쇼킹딜", "핫딜", "타임딜", "게릴라", "멤버십", "VIP", "프리미엄",
#     "첫구매", "신규가입", "재구매", "구매시", "추가할인", "즉시할인", "앱전용", "온라인단독", "오프라인", "한정판",
#     "콜라보", "리미티드", "베스트셀러", "스테디셀러", "신상품", "출시", "기념", "단독", "독점", "콜렉션",
#     "시즌오프", "클리어런스", "아울렛", "대방출", "초특가", "땡처리", "원가이하", "최대", "최상", "베스트",
#     "탑", "인기", "히트", "필수", "추천", "소식", "안내", "긴급", "중요", "놓치지마세요",
#     "서두르세요", "지금바로", "확인", "클릭", "다운로드", "설치", "참여", "신청", "문의", "상담",
#     "방문", "예약", "구독", "알림", "팔로우", "공유", "후기", "리뷰", "가이드", "가이드북",
#     "(광고)", "긴급", "마지막", "마감임박", "오늘까지", "서두르세요", "지금바로", "놓치지마세요", "한정", "즉시",
#     "바로가기", "클릭", "구매", "신청", "참여", "확인", "다운로드", "설치", "자세히보기", "더보기",
#     "입장", "접속", "문의", "상담", "예약", "방문", "가입", "구독", "알림", "팔로우",
#     "좋아요", "공유", "받기", "열기", "시작", "완료", "가즈아", "품절임박", "소진시까지", "잔여",
#     "카운트다운", "남은시간", "단하루", "단독진행", "특별구성", "꿀팁", "꿀정보", "인생템", "최애템", "최신정보",
#     "신제품", "신규", "출시", "업데이트", "업그레이드", "솔루션", "제품", "상품", "브랜드", "기술",
#     "혁신", "스마트", "빅데이터", "클라우드", "프로그램", "시스템", "기능", "성능", "디자인",
#     "품질", "안전", "효과", "편리", "간편", "쉬운", "빠른", "맞춤", "개인화", "최적화",
#     "전문", "전문가", "교육", "강좌", "강의", "워크샵", "세미나", "컨퍼런스", "포럼", "온라인",
#     "오프라인", "프리미엄", "명품", "명작", "아트", "컬렉션", "새로운", "핵심", "핵심기술", "새로운시작",
#     "(정보)", "(필독)", "(긴급)", "(중요)", "(공지)", "(수신거부)", "확인", "안내", "소식", "알림",
#     "회원", "고객", "님", "귀하", "드립니다", "전해드립니다", "알려드립니다", "안녕하세요", "감사합니다", "드디어",
#     "놀라운", "믿을수없는", "환상적인", "꿈같은", "특별한", "놓칠수없는", "한정된", "기간동안", "기회", "성공",
#     "부자", "돈", "목표", "달성", "해결", "고민", "걱정", "스트레스", "탈출", "변화",
#     "개선", "최신", "최고", "최대", "최초", "유일", "유익", "유용", "기대하세요", "바로"
# ]
# """
#
# portal_keywords = [
#     "아이디", "비밀번호", "로그인", "로그아웃", "가입", "탈퇴", "회원", "비회원", "정보수정",
#     "이름변경", "이메일", "주소", "전화번호", "휴대폰", "본인인증", "재설정", "환경설정",
#     "개인정보", "보호", "보안", "프로필", "사용자", "내정보", "이용내역", "활동기록", "접속",
#     "관리", "약관동의", "개인정보처리", "권한", "접근", "차단", "해제", "정지", "복구",
#     "계정연동", "등록", "삭제", "생성", "갱신", "만료", "기간", "유효", "메시지",
#     "쪽지", "알림", "푸시", "수신", "발신", "보낸쪽지", "받은쪽지", "읽지않음", "메인화면",
#     "게시판", "댓글", "답글", "확인", "오류", "장애", "복구", "개선", "업데이트", "버전",
#     "새로운", "변경", "추가", "구독", "해지", "신고", "차단목록", "초대", "운영",
#     "스팸", "필터", "정화", "규칙", "안내", "공지사항", "도움말", "질문", "답변", "상담",
#     "문의", "고객센터", "전화", "게시판", "포럼", "커뮤니티", "카페", "블로그", "글쓰기",
#     "회원정보", "등급", "포인트", "알람", "소리", "진동", "팝업", "배너", "시스템", "서비스",
#     "이용", "내역", "기록", "활동", "접속", "관리", "동의", "약관", "정책", "권한", "차단",
#     "해제", "정지", "복구", "계정", "연동", "등록", "삭제", "생성", "갱신", "만료", "기간",
#     "유효", "메시지", "알림", "푸시", "수신", "발신", "보낸", "받은", "읽지않은", "게시물",
#     "댓글", "답글", "공유", "저장"
# ]
#
# advertisement_keywords = [
#     "할인", "세일", "기간한정", "특가", "최저가", "이벤트", "무료", "증정", "쿠폰", "코드",
#     "기획전", "선착순", "한정수량", "특별가", "파격할인", "반값", "보너스", "캐시백", "포인트",
#     "적립", "마일리지", "사은품", "경품", "추첨", "당첨", "응모", "혜택", "찬스", "득템",
#     "빅세일", "메가세일", "슈퍼세일", "쇼킹딜", "핫딜", "타임딜", "게릴라", "멤버십", "VIP",
#     "프리미엄", "첫구매", "신규가입", "재구매", "추가할인", "즉시할인", "앱전용", "온라인단독",
#     "한정판", "콜라보", "리미티드", "베스트셀러", "스테디셀러", "신상품", "출시", "기념",
#     "단독", "독점", "콜렉션", "시즌오프", "클리어런스", "아울렛", "대방출", "초특가", "땡처리",
#     "원가이하", "최대", "최상", "베스트", "탑", "인기", "히트", "필수", "추천", "소식",
#     "긴급", "중요", "놓치지마세요", "서두르세요", "지금바로", "클릭", "다운로드", "설치",
#     "참여", "신청", "문의", "상담", "방문", "예약", "구독", "팔로우", "공유", "후기",
#     "리뷰", "가이드", "가이드북", "(광고)", "마지막", "마감임박", "오늘까지", "즉시",
#     "바로가기", "구매", "자세히보기", "더보기", "입장", "접속", "가즈아", "품절임박",
#     "소진시까지", "잔여", "카운트다운", "남은시간", "단하루", "단독진행", "특별구성", "꿀팁",
#     "꿀정보", "인생템", "최애템", "최신정보", "신제품", "업데이트", "업그레이드", "솔루션",
#     "제품", "상품", "브랜드", "기술", "혁신", "스마트", "AI", "빅데이터", "클라우드",
#     "프로그램", "시스템", "기능", "성능", "디자인", "품질", "안전", "효과", "편리",
#     "간편", "쉬운", "빠른", "맞춤", "개인화", "최적화", "전문", "전문가", "교육",
#     "강좌", "강의", "워크샵", "세미나", "컨퍼런스", "포럼", "온라인", "오프라인",
#     "명품", "명작", "아트", "새로운", "핵심", "핵심기술", "새로운시작", "(정보)",
#     "(필독)", "(긴급)", "(중요)", "(공지)", "(수신거부)", "드립니다", "전해드립니다",
#     "알려드립니다", "안녕하세요", "감사합니다", "드디어", "놀라운", "믿을수없는",
#     "환상적인", "꿈같은", "특별한", "놓칠수없는", "한정된", "기회", "성공", "돈",
#     "목표달성", "고민해결", "걱정탈출", "스트레스", "변화", "개선", "최신", "최고",
#     "최초", "유일", "유익", "유용", "기대하세요", "바로"
# ]
#
# government_keywords = [
#     "국세청", "세금고지", "세금납부", "세금계산서", "연말정산", "소득증명", "소득확인서",
#     "환급안내", "건강보험고지", "국민연금고지", "건강보험료", "국민연금보험료", "고용보험고지",
#     "고지서", "납부기한", "정부24", "민원24", "인증서갱신", "공공기관", "보조금",
#     "보조금신청", "보조금지급", "주민센터", "주민등록증", "주민등록표", "전입신고",
#     "출입국관리", "전자세금계산서", "전자고지서", "세무서", "납세자", "소득공제",
#     "의료비공제", "정책안내", "행정처리", "질병청", "보건", "질병예방", "재난지원금",
#     "긴급재난금", "지원금지급", "재난지원", "복지서비스", "정부알림", "정책공고",
#     "공공데이터", "환경부", "교통안전", "보건복지부", "교육부", "고용노동부",
#     "행정안전부", "문화체육관광부", "산업통상자원부", "통계청", "주민세",
#     "부가가치세", "지방세", "증빙자료", "지자체", "공유재산", "도로점검", "공사안내",
#     "주민참여", "투표안내", "선거결과", "행정서비스", "공증서류", "법제처", "행정처분",
#     "세무조사", "방역지침", "예방접종", "긴급안전정보", "가스검침", "수도검침",
#     "전기검침", "생활민원", "금융감독원", "감독원", "환경검사", "식품안전",
#     "농림축산부", "산림청", "통계공표", "정책해설", "공청회", "가족부", "소득세",
#     "복지부", "병무청", "자원부", "법령", "국토교통부", "제도", "바우처", "안전처",
#     "식품의약품안전처", "병역", "해양수산부", "고용지원금", "에너지바우처"
# ]
#
# finance_keywords = [
#     "카드", "신용카드", "체크카드", "금융", "은행", "명세서", "사용내역", "거래내역",
#     "대출", "이자", "상환", "연체", "계좌", "잔액", "이체", "출금", "입금",
#     "자동이체", "청구서", "납부", "수수료", "결제", "카드승인", "결제알림",
#     "한도초과", "통장", "이체확인", "송금", "환전", "환율",
#     "적금", "예금", "펀드", "증권", "주식", "채권", "금융상품", "리볼빙", "카드대금",
#     "결제내역", "할부", "무이자할부", "모기지론", "담보대출", "신용등급", "신용조회",
#     "인터넷뱅킹", "모바일뱅킹", "금융이체", "조회내역", "계좌번호", "출금내역",
#     "입금내역", "금융알림", "대출상환일", "분할상환", "연체료", "연체이자",
#     "이자율", "대출안내", "카드신청", "회원등급", "포인트적립", "캐시백", "수익률",
#     "거래확인", "출금요청", "입금확인", "자동이체등록", "자동이체해지", "계좌개설",
#     "계좌해지", "금융상담", "명세서발송", "펀드수익", "예금만기", "대출만기",
#     "계좌정지", "카드정지", "카드재발급", "분실신고", "SMS알림", "입출금알림",
#     "한도설정", "해외송금", "송금수수료", "투자증권", "저축은행", "캐피탈",
#     "자산운용", "종합금융", "투자자문", "신용정보", "새마을금고", "단위농협",
#     "보험료", "보험금", "투자", "연금", "신탁", "퇴직연금", "주택담보",
#     "전세자금", "신용대출", "마이너스통장", "청약", "해외주식", "국내주식", "공모주",
#     "로보어드바이저", "비상장", "상장", "선물", "옵션", "부동산", "비트코인",
#     "암호화폐", "디지털자산", "포트폴리오", "운용", "분석", "원리금", "비과세",
#     "확정금리", "변동금리", "만기환급", "중도인출", "계약", "해지", "증권계좌",
#     "종합자산관리", "재테크", "은퇴설계", "상속", "증여", "파생상품",
#     "주가지수연동", "주식형", "채권형", "혼합형", "원금보장", "원금손실",
#     "거치식", "적립식", "주가연계", "파생결합", "대체투자", "특별계정", "일반계정",
#     "변액", "종신", "정기", "건강", "실손", "자동차보험", "화재보험", "여행자보험",
#     "저축보험", "교육보험", "어린이보험", "치아보험", "유가증권", "신탁상품",
#     "퇴직연금상품", "개인형", "확정기여형", "확정급여형", "주택청약", "청약저축",
#     "무이자", "할부금융", "리스", "렌탈", "금리우대", "수수료면제", "카드발급",
#     "카드갱신", "카드해지", "카드정지", "후불교통", "기프트카드", "법인카드",
#     "개인카드", "가족카드", "현금서비스", "카드론", "결제일할인", "무실적카드",
#     "할인카드", "적립카드", "제휴카드", "프리미엄카드", "자동납부", "자동송금",
#     "예약이체", "간편결제", "간편송금", "외화예금", "외화대출", "환율우대",
#     "환리스크", "특판", "특별판매", "저금리", "고금리", "거래", "사용", "승인",
#     "취소", "환불", "정산", "잔고", "증거금", "위탁", "담보", "약정", "매도",
#     "매수", "체결", "미수", "반대매매", "평가손익", "이익", "손실률", "수익률",
#     "손익분기", "미수금", "미지급금", "미납금", "매매", "입출금", "카드사용",
#     "승인번호", "선결제", "부분결제", "청구금액", "미결제", "납입", "납입액",
#     "납입일", "보험청구", "보험금지급", "보험료납입", "보험계약", "보험증권",
#     "보험설계", "보험갱신", "보험만기", "보험료할인", "보험금수령", "보험금청구",
#     "보험료미납", "보험료환급", "보험료인상", "보험료인하", "보험료조회",
#     "보험료계산", "보험료변동", "보험료확정", "보험료납부", "출금정지", "지급정지",
#     "이체한도", "결제한도", "사용한도", "신용한도", "예금자보호", "압류", "채무",
#     "채권추심", "채무조정", "운용보고서", "재무보고서", "부가서비스", "유동성",
#     "건전성", "투자성향"
# ]
#
# finance_keywords = [
#     "카드", "신용카드", "체크카드", "금융", "은행", "명세서", "사용내역", "거래내역",
#     "대출", "이자", "상환", "연체", "계좌", "잔액", "이체", "출금", "입금",
#     "자동이체", "청구서", "납부", "수수료", "결제", "카드승인", "결제알림",
#     "한도초과", "통장", "이체확인", "송금", "환전", "환율",
#     "적금", "예금", "펀드", "증권", "주식", "채권", "금융상품", "리볼빙", "카드대금",
#     "결제내역", "할부", "무이자할부", "모기지론", "담보대출", "신용등급", "신용조회",
#     "인터넷뱅킹", "모바일뱅킹", "금융이체", "조회내역", "계좌번호", "출금내역",
#     "입금내역", "금융알림", "대출상환일", "분할상환", "연체료", "연체이자",
#     "이자율", "대출안내", "카드신청", "회원등급", "포인트적립", "캐시백", "수익률",
#     "거래확인", "출금요청", "입금확인", "자동이체등록", "자동이체해지", "계좌개설",
#     "계좌해지", "금융상담", "명세서발송", "펀드수익", "예금만기", "대출만기",
#     "계좌정지", "카드정지", "카드재발급", "분실신고", "SMS알림", "입출금알림",
#     "한도설정", "해외송금", "송금수수료", "투자증권", "저축은행", "캐피탈",
#     "자산운용", "종합금융", "투자자문", "신용정보", "새마을금고", "단위농협",
#     "보험료", "보험금", "투자", "연금", "신탁", "퇴직연금", "주택담보",
#     "전세자금", "신용대출", "마이너스통장", "청약", "해외주식", "국내주식", "공모주",
#     "로보어드바이저", "비상장", "상장", "선물", "옵션", "부동산", "비트코인",
#     "암호화폐", "디지털자산", "포트폴리오", "운용", "분석", "원리금", "비과세",
#     "확정금리", "변동금리", "만기환급", "중도인출", "계약", "해지", "증권계좌",
#     "종합자산관리", "재테크", "은퇴설계", "상속", "증여", "파생상품",
#     "주가지수연동", "주식형", "채권형", "혼합형", "원금보장", "원금손실",
#     "거치식", "적립식", "주가연계", "파생결합", "대체투자", "특별계정", "일반계정",
#     "변액", "종신", "정기", "건강", "실손", "자동차보험", "화재보험", "여행자보험",
#     "저축보험", "교육보험", "어린이보험", "치아보험", "유가증권", "신탁상품",
#     "퇴직연금상품", "개인형", "확정기여형", "확정급여형", "주택청약", "청약저축",
#     "무이자", "할부금융", "리스", "렌탈", "금리우대", "수수료면제", "카드발급",
#     "카드갱신", "카드해지", "카드정지", "후불교통", "기프트카드", "법인카드",
#     "개인카드", "가족카드", "현금서비스", "카드론", "결제일할인", "무실적카드",
#     "할인카드", "적립카드", "제휴카드", "프리미엄카드", "자동납부", "자동송금",
#     "예약이체", "간편결제", "간편송금", "외화예금", "외화대출", "환율우대",
#     "환리스크", "특판", "특별판매", "저금리", "고금리", "거래", "사용", "승인",
#     "취소", "환불", "정산", "잔고", "증거금", "위탁", "담보", "약정", "매도",
#     "매수", "체결", "미수", "반대매매", "평가손익", "이익", "손실률", "수익률",
#     "손익분기", "미수금", "미지급금", "미납금", "매매", "입출금", "카드사용",
#     "승인번호", "선결제", "부분결제", "청구금액", "미결제", "납입", "납입액",
#     "납입일", "보험청구", "보험금지급", "보험료납입", "보험계약", "보험증권",
#     "보험설계", "보험갱신", "보험만기", "보험료할인", "보험금수령", "보험금청구",
#     "보험료미납", "보험료환급", "보험료인상", "보험료인하", "보험료조회",
#     "보험료계산", "보험료변동", "보험료확정", "보험료납부", "출금정지", "지급정지",
#     "이체한도", "결제한도", "사용한도", "신용한도", "예금자보호", "압류", "채무",
#     "채권추심", "채무조정", "운용보고서", "재무보고서", "부가서비스", "유동성",
#     "건전성", "투자성향"
# ]
# # 테이블 이름 지정
# table_name = 'portal_keywords'
#
# try:
#     with conn.cursor() as cursor:
#         # INSERT IGNORE로 중복 방지
#         sql = f"INSERT IGNORE INTO {table_name} (word) VALUES (%s)"
#         for word in portal_keywords:
#             cursor.execute(sql, (word,))
#     conn.commit()
#     print(f"{len(portal_keywords)}개의 키워드가 '{table_name}' 테이블에 삽입되었습니다.")
# except Exception as e:
#     print("에러 발생:", e)
# finally:
#     conn.close()


import pymysql

# --- 데이터베이스 연결 설정 ---
DB_CONFIG = {
    'host': '10.50.131.18',
    'port': 3306,
    'user': 'user',
    'password': 'user1234',
    'database': 'maildb',
    'charset': 'utf8mb4'  # 한글, 이모지 등을 위해 utf8mb4를 사용하는 것이 좋습니다.
    # 서버, DB, 테이블 인코딩도 utf8mb4로 설정되어야 합니다.
}

# --- 소분류별 키워드 리스트 (이전에 제공해 드린 모든 키워드 리스트를 여기에 붙여넣으세요) ---
# 금융 카테고리 키워드
finance_bank_account_transfer_keywords = [
    "은행", "계좌", "통장", "잔액", "이체", "출금", "입금", "자동이체", "송금",
    "계좌번호", "거래내역", "이체확인", "잔액조회", "입출금내역", "입금확인",
    "출금요청", "자동이체등록", "자동이체해지", "계좌개설", "계좌해지",
    "인터넷뱅킹", "모바일뱅킹", "간편송금", "외화예금", "외화대출", "환전", "환율",
    "금융이체", "금융알림", "납입", "납입액", "납입일", "무통장입금", "모계좌",
    "펌뱅킹", "지로", "자동납부", "예약이체", "예금자보호", "지급정지", "출금정지",
    "이체한도", "한도", "금리", "이자", "정기예금", "자유적금", "청약저축", "주택청약",
    "수수료", "수수료면제", "수수료할인", "외환", "환율우대", "수익률", "투자수익",
    "증거금", "현금", "현금흐름", "현금서비스", "가상계좌", "계좌이체", "공인인증서",
    "금융인증서", "간편인증", "공동인증서", "본인확인", "신분증", "OTP", "보안카드",
    "거래내역조회", "잔액증명", "입금표", "출금표", "거래명세", "거래내역서",
    "입출금알림", "체결내역", "환급금", "추심", "압류", "채무", "채권", "압류해제",
    "채무조정", "채권추심", "압류방지", "가계부채", "기업대출", "가계대출", "원리금",
    "비과세", "확정금리", "변동금리", "중도인출", "거치식", "적립식", "자금관리",
    "자금조달", "자금운용", "자금현황", "영업점", "지점", "본점", "방문", "신청서",
    "제출서류", "구비서류", "양식", "증명서", "확인서", "전자금융", "전자서명", "보안강화"
]

finance_card_payment_keywords = [
    "카드", "신용카드", "체크카드", "결제", "카드대금", "명세서", "청구서", "사용내역",
    "결제내역", "카드승인", "결제알림", "할부", "무이자할부", "일시불", "선결제",
    "부분결제", "청구금액", "미결제", "연체", "연체료", "연체이자", "카드발급",
    "카드신청", "카드갱신", "카드해지", "카드정지", "분실신고", "재발급", "훼손",
    "한도", "이용한도", "결제한도", "사용한도", "신용한도", "한도초과", "한도상향",
    "포인트", "적립", "캐시백", "마일리지", "혜택", "할인", "쿠폰", "프로모션",
    "제휴", "이벤트", "회원등급", "VIP", "프리미엄", "기프트카드", "법인카드",
    "개인카드", "가족카드", "하이패스카드", "후불교통", "간편결제", "페이", "NFC",
    "온라인결제", "오프라인결제", "자동납부", "자동결제", "결제일", "납부일",
    "결제예정금액", "잔여한도", "무실적카드", "할인카드", "적립카드", "제휴카드",
    "프리미엄카드", "전월실적", "연회비", "부가서비스", "국내전용", "해외겸용",
    "해외결제", "원화결제", "카드론", "현금서비스", "리볼빙", "일부결제금액이월약정",
    "결제계좌", "청구할인", "청구서발송", "SMS알림", "APP푸시", "승인번호", "취소",
    "환불", "정산", "가맹점", "가맹점수수료", "카드번호", "CVC", "유효기간", "ARS",
    "ARS결제", "온라인청구서", "페이백", "카드사", "국민카드", "신한카드", "삼성카드",
    "롯데카드", "현대카드", "우리카드", "하나카드", "비씨카드", "BC카드", "이용약관",
    "개인정보", "보안", "간편로그인", "패스워드", "생체인증", "본인인증", "인증서"
]

finance_loan_repayment_keywords = [
    "대출", "대출금", "대출신청", "대출승인", "대출거절", "대출상환", "상환", "원금상환",
    "이자상환", "중도상환", "만기상환", "연체", "연체이자", "연체료", "대출만기",
    "대출안내", "대출금리", "이자율", "변동금리", "확정금리", "신용대출", "담보대출",
    "주택담보대출", "전세자금대출", "모기지론", "햇살론", "새희망홀씨", "사잇돌대출",
    "마이너스통장", "사업자대출", "개인사업자대출", "법인대출", "주택담보", "전세자금",
    "학자금대출", "전세대출", "부동산담보", "전세대금", "소액대출", "비상금대출",
    "직장인대출", "신용등급", "신용점수", "신용조회", "대출한도", "한도조회", "대출심사",
    "대출조건", "대출자격", "대출서류", "필요서류", "구비서류", "제출서류", "신청방법",
    "상환방법", "상환일", "분할상환", "거치기간", "금리인하요구권", "대환대출",
    "채무통합", "채무조정", "개인회생", "파산", "신용회복", "대출상담", "대출문의",
    "대출실행", "대출잔액", "상환내역", "원리금균등", "원금균등", "만기일시상환",
    "변동주기", "가산금리", "우대금리", "최저금리", "최고금리", "대출금리인하",
    "대출이자계산", "대출이자납부", "대출이자환급", "대출원금", "대출기간", "거치식",
    "적립식", "이자납입일", "연체금", "연체횟수", "담보평가", "대출약정", "약정서",
    "대출조건변경", "대출이자면제", "대출이자유예", "대출이자감면", "대출상품",
    "비대면대출", "P2P대출", "온라인대출", "대출가이드", "대출규제", "DSR", "LTV", "DTI",
    "총부채원리금상환비율", "총부채상환비율", "주택담보대출비율", "금융기관", "저축은행",
    "캐피탈", "대부업", "불법대출", "사기대출", "보이스피싱", "안전장치", "규제", "감독"
]

finance_investment_securities_insurance_keywords = [
    "투자", "증권", "주식", "채권", "펀드", "수익률", "투자상품", "금융상품", "포트폴리오",
    "운용", "자산운용", "자산관리", "종합자산관리", "재테크", "은퇴설계", "연금", "퇴직연금",
    "개인형IRP", "확정기여형", "확정급여형", "신탁", "신탁상품", "신탁계정", "투자설명서",
    "운용보고서", "공시", "주가지수", "코스피", "코스닥", "해외주식", "국내주식", "공모주",
    "비상장", "상장", "선물", "옵션", "파생상품", "파생결합", "ETF", "ETN", "ELS", "DLS",
    "로보어드바이저", "암호화폐", "비트코인", "디지털자산", "가상자산", "원금보장", "원금손실",
    "위험자산", "안전자산", "투자성향", "위험등급", "거래", "매수", "매도", "체결", "체결내역",
    "미수", "반대매매", "평가손익", "이익", "손실", "증거금", "위탁", "약정", "유가증권",
    "증권계좌", "계좌개설", "HTS", "MTS", "시세", "주가", "수익", "손실률", "보험", "보험료",
    "보험금", "보험청구", "보험금지급", "보험료납입", "보험계약", "보험증권", "보험설계",
    "보험갱신", "보험만기", "보험료할인", "보험금수령", "보험금청구", "보험료미납",
    "보험료환급", "보험료인상", "보험료인하", "보험료조회", "보험료계산", "보험료변동",
    "보험료확정", "보험료납부", "건강보험", "실손보험", "자동차보험", "화재보험", "여행자보험",
    "저축보험", "교육보험", "어린이보험", "치아보험", "변액보험", "종신보험", "정기보험",
    "CI보험", "GI보험", "유니버셜보험", "종합보험", "단기보험", "생명보험", "손해보험",
    "보험사", "설계사", "보험상담", "계약자", "피보험자", "수익자", "특약", "면책", "약관",
    "계약해지", "계약변경", "보험리모델링", "보험금청구서류", "보험금심사", "보험금심사결과"
]

# 정부 카테고리 키워드
government_tax_keywords = [
    "국세청", "세금고지", "세금납부", "세금계산서", "연말정산", "소득세", "부가가치세",
    "종합소득세", "양도소득세", "법인세", "주민세", "지방세", "재산세", "자동차세",
    "취득세", "등록면허세", "증여세", "상속세", "납세자", "세무서", "세무조사",
    "세무대리인", "세액공제", "소득공제", "환급", "세금환급", "환급안내", "고지서",
    "전자세금계산서", "전자고지서", "국세증명", "납세증명", "소득금액증명",
    "부가가치세신고", "종합소득세신고", "납부기한", "납부방법", "체납", "가산세",
    "세무상담", "세무알림", "세법", "세정", "신고안내", "영수증제출", "증빙자료",
    "과세", "면세", "감면", "세액", "세목", "국세증명서", "지방세납부", "지방세안내",
    "가산금", "세무정보", "세금포인트", "세금계산", "절세", "탈세", "국세상담센터",
    "ARS납부", "은행납부", "위택스", "홈택스", "국세청홈페이지", "납세자연맹", "세정자료",
    "세무조정", "과세자료", "세법개정", "법정신고기한", "수정신고", "기한후신고",
    "세금관련", "국세청알림", "지방세납부", "재산세고지", "취득세납부", "등록면허세",
    "자동차세고지", "환경개선부담금", "면허세", "세입", "국세행정", "지방세행정",
    "세금고민", "세금지원", "세금혜택", "자진납부", "간이과세", "일반과세", "세금납부확인"
]

government_welfare_keywords = [
    "복지", "지원금", "재난지원금", "긴급재난금", "지원금지급", "지원금신청", "지원금안내",
    "보조금", "보조금신청", "보조금지급", "국민연금", "국민연금고지", "국민연금보험료",
    "건강보험", "건강보험고지", "건강보험료", "고용보험", "고용보험고지", "실업급여",
    "육아휴직급여", "출산휴가급여", "산재보험", "사회보험", "복지서비스", "복지혜택",
    "바우처", "에너지바우처", "돌봄서비스", "아동수당", "기초연금", "장애인연금",
    "의료비지원", "의료급여", "기초생활수급", "차상위계층", "저소득층", "청년지원",
    "신혼부부지원", "출산지원", "육아지원", "어르신복지", "취약계층", "복지카드",
    "복지정책", "복지안내", "복지관", "지역복지", "복지재단", "고용지원", "일자리",
    "취업성공패키지", "내일배움카드", "훈련비지원", "국민내일배움카드", "훈련수당",
    "국민취업지원제도", "연금개시", "연금수령", "연금수령액", "연금계산", "퇴직연금",
    "연금지급", "고용안정", "고용유지", "정부지원", "공공지원", "지역화폐", "돌봄쿠폰",
    "긴급돌봄", "긴급지원", "생계비", "주거지원", "교육급여", "장학금", "국가장학금",
    "교육비지원", "자활근로", "근로장려금", "자녀장려금", "여성가족부", "보건복지부",
    "복지부알림", "연금공단", "건강보험공단", "고용노동부", "국민권익위원회", "사회복지사",
    "돌봄서비스", "저소득", "중위소득", "기준중위소득", "복지알림톡", "보호종료아동",
    "한부모가족", "다문화가족", "국민기초생활보장", "긴급생계비", "긴급주거비",
    "긴급의료비", "생계급여", "의료급여", "주거급여", "교육급여", "자활급여"
]

government_admin_policy_keywords = [
    "민원", "민원24", "정부24", "처리결과", "민원처리", "민원접수", "민원안내",
    "주민센터", "행정복지센터", "주민등록", "주민등록증", "주민등록표", "등본", "초본",
    "전입신고", "출입국관리", "인감증명", "인증서갱신", "공동인증서", "금융인증서",
    "정부알림", "정책", "정책안내", "정책공고", "제도", "제도개선", "법령", "법제처",
    "행정", "행정안전부", "공공기관", "공공데이터", "공지", "공고", "공고문", "발표",
    "고시", "예규", "훈령", "조례", "규칙", "행정처분", "행정심판", "행정소송",
    "공청회", "간담회", "설명회", "투표안내", "선거", "선거결과", "행정서비스",
    "본인인증", "공증", "공증서류", "전자문서", "전자정부", "국민신문고", "국민비서",
    "알림톡", "문자알림", "통계청", "통계공표", "통계자료", "통계조사", "국토교통부",
    "교육부", "문화체육관광부", "산업통상자원부", "농림축산식품부", "해양수산부",
    "국가기록원", "본인확인", "정부정책", "정부행정", "민원상담", "정부대표", "안전신문고",
    "공공시설", "공공요금", "고지", "납부", "징수", "관리비", "환경부", "도로명주소",
    "도로점검", "공사안내", "공유재산", "청렴", "윤리", "정보공개", "기록물", "문서",
    "서류", "양식", "증명서", "확인서", "신청서", "제출서류", "구비서류", "절차", "방법",
    "업데이트", "점검", "신분증", "여권", "운전면허증", "건축허가", "개발행위", "인허가"
]

government_safety_health_military_keywords = [
    "재난", "안전", "긴급재난", "재난안내", "안전공지", "안전수칙", "재난문자",
    "예방", "질병", "질병예방", "방역", "방역지침", "예방접종", "코로나19", "감염병",
    "보건", "보건소", "질병관리청", "보건복지부", "식품의약품안전처", "식품안전",
    "의료", "의료기관", "병원", "건강검진", "국민건강", "건강증진", "보건사업",
    "환경", "환경오염", "미세먼지", "대기질", "수질", "환경검사", "환경부",
    "소방", "소방안전", "화재예방", "화재진압", "구조", "구급", "119", "긴급구조",
    "교통안전", "교통사고", "도로교통", "교통안전공단", "교통법규", "운전면허",
    "병무청", "병역", "병역의무", "입영", "입영통지서", "군대", "군사", "동원훈련",
    "예비군", "민방위", "징집", "현역", "사회복무요원", "병역판정검사", "병역의무자",
    "군인", "병역명문가", "병역사항", "병역감면", "병역특례", "병역법", "병역제도",
    "위험", "위험지역", "안전사고", "사고예방", "재해", "재난대비", "국민행동요령",
    "가스안전", "전기안전", "시설안전", "산업안전", "화학물질", "유해물질", "폐기물",
    "소음", "악취", "자연재해", "풍수해", "지진", "산불", "폭염", "한파", "대설",
    "감염병예방", "백신", "접종센터", "검사결과", "음압병상", "확진자", "자가격리",
    "재택치료", "역학조사", "마스크", "손소독", "사회적거리두기", "방역수칙",
    "비상대책", "경보", "주의보", "발령", "해제", "재난문자", "안전지침", "훈련",
    "대피", "대피소", "피해조사", "피해보상", "긴급복구", "재난관리", "재난대응",
    "재난정보", "국가안전"
]

# 포털 카테고리 키워드
portal_account_keywords = [
    "아이디", "비밀번호", "로그인", "로그아웃", "가입", "탈퇴", "회원", "비회원",
    "정보수정", "이름변경", "이메일", "주소", "전화번호", "휴대폰", "본인인증",
    "재설정", "환경설정", "개인정보", "보호", "보안", "프로필", "사용자", "내정보",
    "이용내역", "활동기록", "접속", "관리", "약관동의", "개인정보처리", "권한",
    "접근", "차단", "해제", "정지", "복구", "계정연동", "등록", "삭제", "생성",
    "갱신", "만료", "기간", "유효", "회원정보", "등급", "회원가입", "회원탈퇴",
    "비밀번호변경", "비밀번호초기화", "아이디찾기", "회원번호", "고객번호",
    "회원인증", "인증메일", "인증코드", "회원혜택", "회원전용", "회원등급",
    "명의도용", "계정도용", "부정사용", "로그인기록", "접속기록", "동의철회",
    "개인정보활용", "개인정보수집", "정보변경", "개인설정", "개인정보처리방침",
    "계정잠금", "계정활성화", "계정삭제", "계정복구", "회원약관", "이용약관",
    "비회원로그인", "간편로그인", "자동로그인", "로그인실패", "비정상접속",
    "보안강화", "인증번호", "보안문자", "새로운기기", "접근알림", "회원가입환영",
    "회원정보보호", "개인정보유출", "비밀번호유출", "회원정보변경안내", "회원정보관리",
    "회원정보이용", "회원정보제공", "회원정보파기", "이용자정보", "사용자정보",
    "개인정보취급방침", "개인정보동의", "로그인시도", "회원가입시도", "계정활용",
    "계정권한", "개인설정", "이용약관변경", "회원탈퇴처리", "비밀번호확인"
]

portal_notification_keywords = [
    "메시지", "쪽지", "알림", "푸시", "수신", "발신", "보낸쪽지", "받은쪽지",
    "읽지않음", "공지사항", "공지", "안내", "소식", "정보", "업데이트", "버전",
    "새로운", "변경", "추가", "개선", "점검", "서비스점검", "시스템점검", "긴급점검",
    "정기점검", "예정", "완료", "오픈", "종료", "마감", "시작", "기간", "일정",
    "예고", "발표", "개편", "리뉴얼", "확인", "열람", "보기", "자세히보기", "더보기",
    "알림톡", "문자", "SMS", "이메일", "앱알림", "팝업", "배너", "추천", "이벤트",
    "프로모션", "새소식", "운영정책", "이용약관변경", "개인정보처리방침변경",
    "서비스변경", "서비스종료", "서비스시작", "서비스안내", "서비스이용", "이용약관",
    "취급방침", "정책변경", "알림설정", "알림해제", "알림받기", "알림끄기", "구독",
    "구독해지", "구독신청", "뉴스레터", "정기구독", "회원소식", "고객알림",
    "중요안내", "필독", "중요", "긴급", "참고", "유의", "주의", "필수", "권장",
    "전달", "알려드립니다", "드립니다", "보내드립니다", "수신확인", "확인바랍니다",
    "변경사항", "새기능", "개선사항", "신규", "출시", "점검중", "정상화", "복구완료",
    "안정화", "긴급안내", "재안내", "문의사항", "응답", "회신", "답변", "처리",
    "처리완료", "처리결과", "등록", "생성", "삭제", "수정", "게시", "게재", "작성"
]

portal_community_keywords = [
    "게시판", "게시물", "댓글", "답글", "글쓰기", "작성", "등록", "수정", "삭제",
    "공유", "저장", "스크랩", "북마크", "즐겨찾기", "관심", "좋아요", "싫어요",
    "추천", "비추천", "조회수", "읽음", "조회", "열람", "모임", "카페", "블로그",
    "포럼", "커뮤니티", "그룹", "단체", "대화방", "채팅", "쪽지", "메시지", "소셜",
    "활동", "내활동", "방문자", "이웃", "친구", "팔로우", "팔로잉", "팔로워",
    "초대", "가입", "탈퇴", "운영", "관리", "규칙", "준수", "위반", "신고", "차단",
    "해제", "정지", "게시", "게재", "업로드", "다운로드", "앨범", "갤러리", "사진첩",
    "동영상", "음악", "콘텐츠", "콘텐츠관리", "콘텐츠생성", "미디어", "파일", "첨부",
    "파일첨부", "게시판글쓰기", "댓글작성", "답글달기", "공유하기", "이모티콘",
    "선물", "인기글", "최신글", "베스트", "공지글", "삭제글", "이동", "숨김",
    "보관", "검색", "필터", "정렬", "카테고리", "분류", "주제", "말머리", "열람권한",
    "게시권한", "회원등급", "활동점수", "랭킹", "랭크", "레벨", "칭호", "프로필사진",
    "닉네임", "아이콘", "배경", "테마", "스킨", "설정", "환경", "댓글알림", "게시물알림",
    "채팅알림", "친구추가", "친구삭제", "친구목록", "쪽지함", "보낸쪽지함", "받은쪽지함"
]

portal_security_keywords = [
    "보안", "개인정보", "개인정보보호", "개인정보유출", "정보보호", "계정보안", "비밀번호",
    "비밀번호변경", "비밀번호초기화", "인증", "본인인증", "공인인증서", "금융인증서",
    "공동인증서", "간편인증", "OTP", "보안카드", "이차인증", "이단계인증", "생체인증",
    "지문인증", "안면인증", "보안강화", "보안경고", "보안수칙", "보안설정", "안전",
    "안전이용", "사기", "피싱", "스미싱", "파밍", "해킹", "악성코드", "바이러스", "불법",
    "부정사용", "명의도용", "계정도용", "의심거래", "비정상로그인", "접속알림", "경고",
    "주의", "유의사항", "불법스팸", "스팸차단", "스팸신고", "고객센터", "도움말", "문의",
    "상담", "신고", "건의", "불만", "제안", "오류", "장애", "문제", "해결", "처리",
    "시스템", "네트워크", "서버", "점검", "안정화", "업데이트", "버전", "시스템오류",
    "접속장애", "서비스장애", "기술지원", "FAQ", "자주묻는질문", "사용자매뉴얼", "이용안내",
    "개인정보취급방침", "약관", "이용약관", "운영정책", "준수", "안내문", "공지사항",
    "알림", "주의사항", "필독", "중요", "긴급", "보안메일", "개인정보동의", "보안시스템",
    "백신", "방화벽", "취약점", "데이터암호화", "정보유출", "개인정보침해", "보안이슈",
    "정보보안"
]

# Advertisement Category Keywords
advertisement_discount_keywords = [
    "할인", "세일", "특가", "최저가", "반값", "무료", "증정", "쿠폰", "할인쿠폰",
    "캐시백", "포인트", "적립", "마일리지", "혜택", "찬스", "득템", "이벤트",
    "기획전", "프로모션", "사은품", "경품", "추첨", "당첨", "응모", "보너스",
    "추가할인", "즉시할인", "청구할인", "앱전용", "온라인단독", "멤버십", "VIP",
    "프리미엄", "첫구매", "신규가입", "재구매", "할인가", "특가전", "빅세일",
    "메가세일", "슈퍼세일", "쇼킹딜", "핫딜", "타임딜", "게릴라", "원가이하",
    "최대", "최상", "베스트", "인기", "히트", "필수", "추천", "특판", "특별판매",
    "금리우대", "수수료면제", "할부금융", "리스", "렌탈", "할인율", "적립율",
    "할인코드", "쿠폰번호", "증정품", "사은품증정", "할인혜택", "적립혜택",
    "특별혜택", "이벤트참여", "이벤트당첨", "추첨이벤트", "경품추첨", "선물",
    "기프트", "경품증정", "할인행사", "쿠폰적용", "페이백", "포인트사용", "무료증정",
    "할인대상", "쿠폰지급", "증정품", "할인코드", "시크릿코드", "특별바우처",
    "쿠폰할인", "카드할인", "제휴할인", "패키지할인", "세트할인", "정액할인",
    "정률할인", "최저가보장", "가격비교", "특가상품", "기간한정", "선착순", "한정수량",
    "단독할인", "추가적립", "보너스포인트", "리워드", "할인율", "할인폭", "할인가격"
]

advertisement_product_keywords = [
    "신상품", "출시", "신제품", "새로운", "업데이트", "업그레이드", "솔루션", "제품",
    "상품", "브랜드", "기술", "혁신", "스마트", "AI", "빅데이터", "클라우드",
    "프로그램", "시스템", "기능", "성능", "디자인", "품질", "안전", "효과",
    "편리", "간편", "쉬운", "빠른", "맞춤", "개인화", "최적화", "전문", "전문가",
    "베스트셀러", "스테디셀러", "한정판", "콜라보", "리미티드", "독점", "단독",
    "콜렉션", "시즌오프", "클리어런스", "아울렛", "대방출", "인생템", "최애템",
    "최신정보", "신규", "기술력", "혁신기술", "새로운시작", "핵심기술", "최고급",
    "명품", "명작", "아트", "컬렉션", "특징", "장점", "효능", "효과", "성분",
    "재료", "소재", "특허", "인증", "수상", "검증", "인기상품", "추천상품",
    "베스트상품", "새로운모델", "신규서비스", "최신버전", "업그레이드된", "솔루션제공",
    "제품소개", "상품정보", "브랜드스토리", "기술력소개", "혁신적인", "스마트한",
    "프로그램안내", "시스템안내", "기능개선", "성능향상", "디자인특징", "품질보증",
    "안전성", "효율성", "편의성", "간편성", "신속성", "정확성", "맞춤형", "개인맞춤",
    "최적화된", "전문가추천", "전문기술", "차별화된", "경쟁력", "독자적인", "첨단기술",
    "미래기술", "넥스트", "얼리버드", "한정판매", "리미티드에디션", "시그니처",
    "마스터피스", "프리미엄급", "고급형", "보급형", "플래그십", "프리미엄서비스",
    "무료체험", "체험단", "무료이용", "체험이벤트", "가이드", "가이드북", "매뉴얼"
]

advertisement_cta_urgency_keywords = [
    "지금바로", "놓치지마세요", "서두르세요", "마감임박", "오늘까지", "단하루",
    "클릭", "구매", "신청", "참여", "확인", "다운로드", "설치", "자세히보기",
    "더보기", "입장", "접속", "문의", "상담", "예약", "방문", "가입", "구독",
    "알림", "팔로우", "좋아요", "공유", "받기", "열기", "시작", "완료", "가즈아",
    "품절임박", "소진시까지", "잔여", "카운트다운", "남은시간", "단독진행",
    "특별구성", "꿀팁", "꿀정보", "최신", "최고", "최대", "최초", "유일", "유익",
    "유용", "기대하세요", "바로", "긴급", "중요", "필독", "마지막", "반드시",
    "서둘러", "서두르지", "지금", "즉시", "지금바로확인", "신청하세요", "참여하세요",
    "구매하세요", "클릭하세요", "다운받으세요", "설치하세요", "놓치지마세요",
    "빨리", "서둘러주세요", "기간한정", "한정판매", "한정수량", "선착순", "곧마감",
    "마감", "오늘마감", "시간제한", "기간엄수", "최대할인", "마지막기회", "놓칠수없는",
    "특별한", "필수템", "인생템", "최애템", "핫아이템", "강력추천", "절대놓치지마세요",
    "특별한기회", "매진임박", "완판임박", "최저가도전", "이벤트참여", "지금참여",
    "지금신청", "지금구매", "새롭게", "드디어", "놀라운", "믿을수없는", "환상적인",
    "꿈같은", "이루어질", "성공", "부자", "돈", "목표달성", "고민해결", "걱정탈출",
    "스트레스", "변화", "개선", "시작하세요", "시작해보세요", "달라진", "특별한",
    "놓칠수없는", "기간동안", "기회", "해결", "결정", "지금이순간", "최적의", "최고의"
]

# 매핑된 소분류 이름과 해당 키워드 리스트
subcategory_data = {
    'Bank/Account/Transfer': finance_bank_account_transfer_keywords,
    'Card/Payment': finance_card_payment_keywords,
    'Loan/Repayment': finance_loan_repayment_keywords,
    'Investment/Securities/Insurance': finance_investment_securities_insurance_keywords,
    'Tax/National & Local': government_tax_keywords,
    'Welfare/Support/Pension': government_welfare_keywords,
    'Civil Petition/Administration/Policy': government_admin_policy_keywords,
    'Safety/Health/Military Service': government_safety_health_military_keywords,
    'Account/Membership Management': portal_account_keywords,
    'Service Notification/Information': portal_notification_keywords,
    'Community/Activity': portal_community_keywords,
    'Security/Guidance': portal_security_keywords,
    'Discount/Benefit/Promotion': advertisement_discount_keywords,
    'Product/Service/Launch': advertisement_product_keywords,
    'Call-to-Action/Urgency': advertisement_cta_urgency_keywords
}


def insert_keywords_into_db():
    conn = None  # 연결 객체 초기화
    cursor = None  # 커서 객체 초기화
    try:
        # 데이터베이스 연결
        conn = pymysql.connect(**DB_CONFIG)
        cursor = conn.cursor()

        print("--- 키워드 삽입 시작 ---")

        for subcategory_name, keywords_list in subcategory_data.items():
            # 소분류 ID 조회
            # subcategory_name이 영문으로 변경되었으므로, 해당 영문 이름으로 ID를 조회합니다.
            select_subcategory_id_query = "SELECT subcategory_id FROM Subcategories WHERE subcategory_name = %s"
            cursor.execute(select_subcategory_id_query, (subcategory_name,))
            result = cursor.fetchone()

            if result:
                subcategory_id = result[0]
                print(f"Subcategory '{subcategory_name}' (ID: {subcategory_id})에 키워드 삽입 중...")

                # 각 키워드 삽입
                # INSERT IGNORE는 이미 존재하는 키워드는 무시하고 넘어갑니다.
                # 이는 스크립트를 여러 번 실행해도 중복 삽입 오류가 발생하지 않도록 합니다.
                insert_keyword_query = "INSERT IGNORE INTO Keywords (subcategory_id, keyword_text) VALUES (%s, %s)"

                # 대량 삽입을 위한 리스트 생성
                keywords_to_insert = [(subcategory_id, keyword) for keyword in keywords_list]

                # executemany를 사용하여 성능 향상
                cursor.executemany(insert_keyword_query, keywords_to_insert)
                print(f"'{subcategory_name}'에 {cursor.rowcount}개의 키워드 삽입 또는 업데이트 완료.")
            else:
                print(f"경고: Subcategory '{subcategory_name}'을(를) 찾을 수 없습니다. 해당 키워드는 삽입되지 않았습니다.")

        # 변경사항 커밋
        conn.commit()
        print("\n--- 모든 키워드 삽입 작업 완료 ---")

    except pymysql.Error as err:  # pymysql의 오류는 pymysql.Error로 잡습니다.
        print(f"데이터베이스 오류 발생: {err}")
        if conn:  # conn이 None이 아닌 경우에만 rollback 시도
            conn.rollback()  # 오류 발생 시 롤백
            print("오류로 인해 작업이 롤백되었습니다.")
    finally:
        # 연결 종료
        if cursor:
            cursor.close()
        if conn:  # conn이 None이 아닌 경우에만 close 시도
            conn.close()
            print("데이터베이스 연결 종료.")


if __name__ == "__main__":
    insert_keywords_into_db()